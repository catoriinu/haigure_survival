# ビーム回避FPS（仮）仕様書（最終改訂版）

更新日: 2025-12-26

## 1. ゲーム概要
本作は、3D空間内でプレイヤーおよび複数のNPCが同一フィールドに存在し、
空中を飛行する複数のビットから発射されるビームを回避し続ける
生存時間スコアアタック型FPSゲームである。

キャラクター（プレイヤー・NPC）は一枚絵で表現され、
敵であるビットは3Dオブジェクトとして表現される。
フィールド内の全キャラクターが撃破された時点でゲームオーバーとなる。

## 2. ゲームの最小完成条件（MVP）
以下の条件をすべて満たした時点で、本作は「完成」とみなす。

- プレイヤーが操作可能であること
- タイトル画面が存在すること
- ゲーム中、以下の操作が可能であること
  - 前後移動
  - 左右移動
  - マウスによる視点操作
- 屋内フィールドが1種類以上存在すること
- フィールド内にプレイヤー以外のNPCが存在すること
- プレイヤーおよびNPCが一枚絵キャラクターとして表示されること
- 敵ビットが3Dオブジェクトとして表示されること
- ビームに当たると、プレイヤー・NPCともに戦闘不能になること
- 全キャラクター（プレイヤー＋NPC）が撃破された場合にゲームオーバーとなること
- ゲームオーバー時にリザルト画面が表示されること
  - 生存時間が表示される
- リトライが容易であること
- 終了条件を満たした後、タイトル画面に戻れること

## 3. 視点・操作仕様
### 視点
- 完全FPS視点
- プレイヤーの体モデルは使用しない
- カメラを基準とした一人称視点

### 操作
- 移動：前後・左右
- 視点操作：マウス
- ジャンプ：なし

### 操作補足（追記）
- FPS視点のため、ゲーム開始時にポインタロックを有効化する
- ポインタロック解除はEscキーで行える

## 4. フィールド仕様
### 共通仕様
- 箱型の閉じた空間を基本とする
- 壁・床・天井を持つ
- フィールド外への移動は不可

### フィールド生成ルール（追記）
- フィールドはセル状のグリッドで管理する
- セルサイズ：12 x 12
- グリッドサイズ：20 x 20 セル
- セルの状態：床 / 壁
- 連結した床セルは「部屋」として扱う
- 1セル幅の床が連続し、両脇が壁の場合は「道」として扱う
- 初期ルール：部屋が3つで、必ず道で繋がる一本道

### 屋内フィールド（優先実装）
- 種別：屋内
- 空間イメージ：建物内部・部屋
- 床：
  - 色：紫色
  - 2単位ごとの格子線を入れる
- 壁・天井：
  - 色：灰色
  - 壁は2単位ごとの格子線を入れる
- 視認性を重視し、キャラクターやビームが見やすい配色とする

### 屋外フィールド（将来対応）
- 存在は想定するが、詳細仕様は未定
- 本仕様書では実装対象外とする

## 5. キャラクター共通仕様（プレイヤー・NPC）
### 表現方法
- キャラクターは一枚絵（スプライト）で表現する
- 常にカメラ正面を向くように回転追従する（ビルボード方式）
- 見た目と当たり判定は独立して扱う

### 当たり判定
- 当たり判定形状：円柱型
- 当たり判定は内部処理用であり、可視化しない

## 6. プレイヤーの仕様
### 基本仕様
- FPS操作主体となるキャラクター
- 移動・視点操作が可能
- 初期配置は必ず部屋の内部とする

### 表示に関する方針
- プレイヤー自身の一枚絵表示については未確定
- 実装する場合はNPCと同等のビルボード方式を採用する

### 被弾ルール
- ビームに1回でもヒットすると戦闘不能
- 戦闘不能後は操作不能となるが、ゲームは継続する
- カメラはその場で待機可能

## 7. NPC（味方キャラクター）の仕様
### 基本仕様
- プレイヤーと同陣営のノンプレイヤーキャラクター
- フィールド内に複数体存在する
- 攻撃能力は持たない

### 行動
- フィールド内をランダム、またはルールに基づいて走り回る
- ビットの攻撃対象となる

### 表示状態（ステータス別）
NPCの一枚絵は、以下の少なくとも3状態で切り替える。

1. 逃走中
2. 被弾時
3. 撃破後

各状態は別画像として管理する。

### 被弾ルール
- ビームに1回でもヒットすると即戦闘不能
- 撃破後は行動不能、復活なし

## 8. 敵（ビット）の仕様
### 基本仕様
- 敵は「ビット」と呼ばれる
- 初期出現数：1体
- 時間経過により出現数が増加する

### 見た目（ビジュアル仕様）
- 3Dオブジェクトとして表現する
- 形状：
  - 基本形状：円錐
  - 錐の頂点部分に、丸い発射口を持つ
- 状態：
  - 常に空中に浮遊している
- 発射口は、ビームの発射方向を視覚的に示す役割を持つ

### 配置・移動
- フィールド内の上空を浮遊
- 前後・左右・上下すべての方向に移動可能

### 行動・ターゲット
- 攻撃対象：
  - プレイヤー
  - NPC
- 一部のビットは以下の挙動を持つ
  - 対象を発見すると追尾する
- その他のビットは以下の挙動も持ち得る
  - ランダム方向にビームを発射する

## 9. 攻撃（ビーム）の仕様
- 攻撃手段：円柱型ビーム
- 発射元：ビットの発射口
- 発射方向：基本は直線
- 太さ：細め
- 速度：避けにくいが回避可能な速さ
- 同時存在数：多め
- 寿命：
  - フィールド外に出たら消滅

## 10. 当たり判定ルール
- 判定対象：
  - ビーム × プレイヤー
  - ビーム × NPC
- ビームが対象キャラクターに接触した場合、ヒットと判定
- ヒット時の結果：
  - 即戦闘不能

## 11. ゲーム進行・終了ルール
### 状態定義
- 生存中：プレイヤー操作可能
- プレイヤー戦闘不能
  - 操作不能
  - 観戦・待機状態
  - NPCとゲーム進行は継続
- 全滅
  - プレイヤーおよび全NPCが戦闘不能
  - ゲームオーバー

### スコア
- スコア形式：生存時間
- 計測終了タイミング：全滅時

## 12. 難易度変化の方針
- 時間経過により難易度上昇
- 主な変化要素：
  - ビット出現数の増加
  - ビーム発射頻度の増加

## 13. 演出・表現方針
- エフェクトは比較的派手にしてよい
- ビットの発射口・ビーム発射方向が視覚的に分かることを重視する

## 14. 今回やらないこと（非対象）
- プレイヤー・NPCの3Dモデル実装
- 敵の高度なAIロジック
- 物理エンジン依存の複雑な挙動
- 屋外フィールドの実装
- ストーリー要素

## 15. 開発方針メモ
- 一枚絵（キャラ）＋3D（敵）の混在前提で設計する
- 見た目と当たり判定を明確に分離する
- 屋内フィールドを基準にゲームバランスを調整する
- 将来、屋外フィールド追加を想定した拡張可能な構成とする

## 16. 画面構成・遷移（追記）
- タイトル画面 → ゲーム画面 → リザルト画面 → タイトル画面
- リザルト画面からリトライ可能

## 17. プラットフォーム・配布（追記）
- ブラウザ配布：Viteビルド成果物
- Windows配布：Electronビルド成果物

## 18. ミニマップ（追記）
- 画面左上に常時表示する
- 現在地を中心に表示する
- フィールドを上から見たときに、床/壁が色で判別できる
- 将来的にボタンでオン/オフ切り替え可能にする
- 現在座標をミニマップ付近に表示する
- プレイヤーの視界方向を扇形で表示する
