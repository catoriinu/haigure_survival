# ルーレット実装（このブランチ差分全体）リファクタリング 計画

更新日: 2026-02-23

## プロンプト
PLEASE IMPLEMENT THIS PLAN:
# ルーレット実装（このブランチ差分全体）リファクタリング計画

## 概要
このブランチで追加したルーレット関連差分を、挙動を維持しつつ責務単位に再編します。
主目的は `src/main.ts` への集中を解消し、ルーレット本体・タイトル設定制限・回転プロファイル・音声制御を分離して、今後の調整コストと回帰リスクを下げることです。
方針は「軽微改善許可」「コミット小分け」「`build + 手動シナリオ一式` 検証」「README同期」です。

## ステップ
- [x] ルーレット用ステージ判定とタイトル設定制限ルールを分離
- [x] ルーレット回転プロファイルを純関数化
- [ ] ルーレット状態機械を `RouletteSystem` へ抽出
- [ ] ルーレット回転SE制御を `RouletteSystem` 側へ集約
- [ ] HUD連携を `RouletteSystem.getStats()` 経由に統一
- [ ] README/docsを現行実装値へ同期し、最終確認を実施

## 結果
- ステップ1完了: `src/ui/titleStageRules.ts` を追加し、タイトル設定制限と実行時正規化を `main.ts` から分離
- ステップ2完了: 回転プロファイルを `src/game/roulette/spinProfile.ts` に分離し、`main.ts` 側の角度/音量計算を純関数呼び出しへ移行
